<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CinePrompt Master</title>
    <!-- iOS App 支援標籤 -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="CinePrompt">
    
    <!-- React & Tailwind CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        body { background-color: #070708; color: #e4e4e7; -webkit-tap-highlight-color: transparent; }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #27272a; border-radius: 20px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #3f3f46; }
        select { -webkit-appearance: none; appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23666'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 0.5rem center; background-size: 1rem; }
        @media (max-width: 640px) { select, textarea, button { font-size: 16px !important; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // 手動定義 Lucide 圖示以避免 CDN 組件衝突問題
        const Icon = ({ name, size = 16, className = "" }) => {
            useEffect(() => {
                if (window.lucide) { window.lucide.createIcons(); }
            }, [name]);
            return <i data-lucide={name} style={{ width: size, height: size }} className={className}></i>;
        };

        const App = () => {
            // --- 專業資料庫完整化 (含效果說明) ---
            const config = {
                cameras: [
                    { id: 'arri65', name: 'ARRI Alexa 65', desc: '阿萊 Alexa 65：頂級電影感，極致動態範圍。', prompt: 'shot on ARRI Alexa 65, ALEV 3 A3X sensor, legendary cinematic dynamic range' },
                    { id: 'imax70', name: 'IMAX 15/70mm', desc: 'IMAX 70釐米底片：史詩畫幅，極致解析度。', prompt: 'shot on IMAX 15/70mm film, massive 18k resolution, ultra-wide gate' },
                    { id: 'raptor', name: 'RED V-Raptor XL', desc: 'RED 猛禽：極度銳利、高反差現代商業質感。', prompt: 'shot on RED V-Raptor XL, 8K VistaVision, sharp modern commercial contrast' },
                    { id: 'venice2', name: 'Sony VENICE 2', desc: '索尼威尼斯 2：精準還原色彩，膚色自然純淨。', prompt: 'shot on Sony VENICE 2, CineAlta color science, natural skin tones, high ISO purity' },
                    { id: 'dxl2', name: 'Panavision Millennium DXL2', desc: '帕那維申 DXL2：好萊塢質感，獨特色彩科學。', prompt: 'shot on Panavision Millennium DXL2, 8K Large Format, distinct Panavision color' },
                    { id: 'phaseone', name: 'Phase One XF IQ4', desc: '飛思一億畫素：極致商攝，細節爆棚。', prompt: 'shot on Phase One XF IQ4 150MP, medium format clarity, commercial macro precision' },
                    { id: 'h6d', name: 'Hasselblad H6D-100c', desc: '哈蘇中幅：色彩深度極高，適合高端人像。', prompt: 'shot on Hasselblad H6D-100c, high color depth, elite commercial aesthetic' },
                    { id: 'm11m', name: 'Leica M11 Monochrom', desc: '徠卡黑白機：純粹黑白灰階，高對比銳利度。', prompt: 'shot on Leica M11 Monochrom, pure B&W photography, high contrast grayscale' },
                    { id: 'phantom', name: 'Phantom Flex4K', desc: '高速攝影機：凍結液體、慢動作特效。', prompt: 'shot on Phantom Flex4K, high-speed photography, liquid splash freeze' },
                    { id: 'ursa12k', name: 'Blackmagic URSA 12K', desc: 'BMD 12K：極致數位細節，色彩科學偏膠片。', prompt: 'shot on Blackmagic URSA Mini Pro 12K, high resolution detail, filmic color' },
                    { id: 'bolex', name: '16mm Bolex H16', desc: '16釐米伯萊克斯：獨立電影感，邊緣柔和。', prompt: 'shot on 16mm Bolex H16, vintage 16mm film grain, soft edges' },
                    { id: 'super8', name: 'Super 8mm Film', desc: '超8底片：家庭錄影帶質感，懷舊粗顆粒。', prompt: 'shot on Super 8mm film, nostalgic grainy home video aesthetic' },
                    { id: 'gopro', name: 'GoPro Hero 12', desc: '運動機：超廣角、魚眼變形、極限視角。', prompt: 'shot on GoPro Hero 12, wide fisheye lens, action camera perspective' },
                    { id: 'mavic3', name: 'DJI Mavic 3 Cine', desc: '無人機：航拍俯瞰視角，廣闊平穩運鏡。', prompt: 'shot on DJI Mavic 3 Cine, aerial drone perspective, sweeping landscape' },
                    { id: 'sx70', name: 'Polaroid SX-70', desc: '寶麗來：柔焦、偏色、白色邊框質感。', prompt: 'shot on Polaroid SX-70, instant film aesthetic, soft focus, square white border' },
                    { id: 'f3', name: 'Nikon F3', desc: '尼康 F3：經典新聞攝影質感，樸實剛硬。', prompt: 'shot on Nikon F3, 35mm photojournalism aesthetic, robust analog look' },
                    { id: '5d4', name: 'Canon 5D Mark IV', desc: '佳能 5D4：標準商用數位單眼，色彩討喜。', prompt: 'shot on Canon EOS 5D Mark IV, standard DSLR look, vibrant warm tones' },
                    { id: 'gfx100', name: 'Fujifilm GFX 100 II', desc: '富士中幅：獨特色彩模擬，極高寬容度。', prompt: 'shot on Fujifilm GFX 100 II, medium format depth, film simulation colors' },
                    { id: 'thermal', name: 'Thermal Camera', desc: '熱成像儀：紅外線熱感視覺，彩虹色譜。', prompt: 'shot on thermal imaging camera, infrared heat signature, rainbow spectrum' },
                    { id: 'nightvision', name: 'Night Vision', desc: '夜視鏡：單色螢光綠，佈滿高感噪點。', prompt: 'shot through military night vision goggles, monochromatic green phosphor glow' }
                ],
                lenses: [
                    { id: 'cooke', name: 'Cooke S4/i Prime', desc: '庫克鏡頭：膚色溫潤，經典庫克感焦外。', prompt: 'Cooke S4/i Prime lens, warm "Cooke Look", organic highlights' },
                    { id: 'panamorph', name: 'Panavision Anamorphic', desc: '帕那維申變形鏡：藍色耀光，橢圓散景。', prompt: 'Panavision C-Series Anamorphic lens, horizontal blue flares, oval bokeh' },
                    { id: 'leicalux', name: 'Leica Summilux-C', desc: '徠卡電影鏡：微反差極高，銳利通透。', prompt: 'Leica Summilux-C, high micro-contrast, optical clarity' },
                    { id: 'zeisssup', name: 'Zeiss Supreme Prime', desc: '蔡司：現代乾淨冷調，強烈科技感。', prompt: 'Zeiss Supreme Prime, clean modern rendering, cool surgical precision' },
                    { id: 'k35', name: 'Canon K-35 Vintage', desc: '佳能古董：復古暖調，低反差光暈。', prompt: 'vintage Canon K-35 prime, nostalgic warm bloom, low contrast' },
                    { id: 'helios', name: 'Helios 44-2', desc: '八羽怪：極致螺旋散景，中心銳利。', prompt: 'Helios 44-2 lens, extreme swirly radial bokeh, center sharpness' },
                    { id: 'probe', name: 'Laowa 24mm Probe', desc: '老蛙探針：蟲視角微距，穿越物體內部。', prompt: 'Laowa 24mm Probe lens, bug-eye perspective, tubular macro depth' },
                    { id: 'tiltshift', name: 'Tilt-Shift Lens', desc: '移軸鏡：微縮模型效果，修正建築透視。', prompt: 'tilt-shift lens effect, miniature model aesthetic, parallel perspective' },
                    { id: 'split', name: 'Split Diopter', desc: '雙焦分光鏡：前後景同時清晰的超現實。', prompt: 'split diopter shot, dual focus planes, surreal deep focus' },
                    { id: 'petzval', name: 'Petzval Art Lens', desc: '佩茲瓦爾：旋轉焦外，中心銳利模糊。', prompt: 'Petzval art lens, swirly bokeh, sharp central focus' },
                    { id: 'fisheye', name: 'Fisheye Lens', desc: '魚眼：180度球形畸變，強調主體。', prompt: 'extreme fisheye distortion, 180-degree field of view' },
                    { id: 'macro100', name: 'Macro 100mm', desc: '百微：極致特寫，展現細膩紋理。', prompt: '100mm macro lens, extreme magnification of surface details' },
                    { id: 'tele70200', name: '70-200mm Telephoto', desc: '長焦：強烈空間壓縮，景深背景貼近。', prompt: '70-200mm telephoto lens, compressed perspective, tight framing' },
                    { id: 'noct095', name: 'Noctilux f/0.95', desc: '夜神：超寫實淺景深，夢幻虛化。', prompt: 'Noctilux f/0.95 lens, paper-thin depth of field, dreamy bokeh' },
                    { id: 'star', name: 'Star Filter', desc: '星芒鏡：光源處產生精緻十字星芒。', prompt: 'cross-screen star filter effect, 4-point star highlights' },
                    { id: 'promist', name: 'Pro-Mist Filter', desc: '柔光鏡：高光溢出，呈現夢幻膚色。', prompt: '1/4 black pro-mist filter, highlight bloom, soft dreamy skin' },
                    { id: 'kaleido', name: 'Kaleidoscope', desc: '萬花筒：畫面分裂重影，迷幻視覺。', prompt: 'kaleidoscope prism filter, multi-faceted reflections, trippy visuals' },
                    { id: 'nd', name: 'ND Filter', desc: '減光鏡：捕捉強光下電影級動態模糊。', prompt: 'neutral density filter, cinematic long exposure motion blur' },
                    { id: 'angenieux', name: 'Angénieux Optimo', desc: '安琴變焦：極致滑順質感與電影氛圍。', prompt: 'Angénieux Optimo zoom, creamy cinema texture' },
                    { id: 'lensbaby', name: 'Lensbaby Composer', desc: '移軸：焦點自由移動，邊緣拉伸。', prompt: 'Lensbaby Composer, selective focus, radial stretching blur' }
                ],
                lighting: [
                    { id: 'threepoint', name: 'Three-Point Lighting', desc: '三點照明：標準商攝立體感佈光。', prompt: 'professional three-point lighting (key, fill, back)' },
                    { id: 'highkey', name: 'High-Key', desc: '高明調：亮麗少影，高端美妝與產品。', prompt: 'high-key lighting, bright airy aesthetic, minimal shadows' },
                    { id: 'lowkey', name: 'Low-Key', desc: '低暗調：高反差厚重感，神祕氣息。', prompt: 'low-key lighting, heavy shadows, high contrast cinematic drama' },
                    { id: 'silhouette', name: 'Silhouette', desc: '剪影：強背光僅留黑色圖形輪廓。', prompt: 'silhouette photography, strong backlight, pitch black subject' },
                    { id: 'chiaroscuro', name: 'Chiaroscuro', desc: '明暗對照：劇性光影，模仿大師繪畫。', prompt: 'chiaroscuro lighting, dramatic Caravaggio style contrast' },
                    { id: 'rembrandt', name: 'Rembrandt', desc: '林布蘭：最強層次感的臉部倒三角光。', prompt: 'Rembrandt lighting, triangle cheek highlight, moody portrait' },
                    { id: 'butterfly', name: 'Butterfly Lighting', desc: '蝴蝶光：時尚標配，鼻下輕盈影。', prompt: 'butterfly lighting, glamour shadow under nose, fashion style' },
                    { id: 'softbox', name: 'Softbox Lighting', desc: '柔光箱：均勻漫射，商攝標準無硬影。', prompt: 'softbox diffused lighting, smooth shadow gradients' },
                    { id: 'hardlight', name: 'Hard Light', desc: '硬光：陰影銳利，模擬直射烈日。', prompt: 'hard lighting, sharp defined shadows, high directional intensity' },
                    { id: 'rimlight', name: 'Rim Light / Backlight', desc: '輪廓光：勾勒邊緣，將主體與背景分離。', prompt: 'powerful rim lighting, glowing edges, separation light' },
                    { id: 'volumetric', name: 'Volumetric', desc: '體積光：光束路徑可見，營造空氣感。', prompt: 'volumetric lighting, visible light beams, cinematic haze' },
                    { id: 'candle', name: 'Candlelight', desc: '燭光：暖色溫營造親密古樸氛圍。', prompt: '1800K candlelight, flickering warm amber glow' },
                    { id: 'golden', name: 'Golden Hour', desc: '黃金時刻：日落暖金光，暖感優雅。', prompt: 'natural golden hour sun, long shadows, 3500K warm glow' },
                    { id: 'blue', name: 'Blue Hour', desc: '藍調時刻：日落冷藍，科技感十足。', prompt: 'cold blue hour lighting, sapphire sky reflection' },
                    { id: 'neon', name: 'Neon Noir', desc: '霓虹黑色電影：科幻霓虹未來感。', prompt: 'neon noir lighting, cyan and magenta color cast' },
                    { id: 'gobo', name: 'Gobo Projection', desc: '遮光片投影：投射百葉窗/樹葉陰影。', prompt: 'gobo lighting, shadow patterns of blinds and leaves' },
                    { id: 'tyndall', name: 'Tyndall Effect', desc: '丁達爾：大氣光束，物理空間感。', prompt: 'Tyndall effect, divine god rays through window' },
                    { id: 'slash', name: 'Slash Lighting', desc: '條狀光：窄長硬光，定義局部焦點。', prompt: 'slash lighting, thin strip of intense hard light' },
                    { id: 'specular', name: 'Specular', desc: '鏡面高光：強調金屬與精密材質質感。', prompt: 'intense specular highlights on metallic surfaces' },
                    { id: 'negfill', name: 'Negative Fill', desc: '負補光：吸光板強化陰影與深度。', prompt: 'negative fill, deep rich shadows, defined profile' }
                ],
                luts: [
                    { id: 'correct', name: 'Color Accurate', desc: '色彩準確：精準校準的色彩還原。', prompt: 'calibrated color accuracy, neutral reference profile' },
                    { id: 'commercial', name: 'Commercial', desc: '頂級商攝：高貴乾淨的高端商業色。', prompt: 'high-end commercial editorial color science, standard white balance' },
                    { id: 'portra400', name: 'Kodak Portra 400', desc: '柯達 400：人像首選，溫潤膚色。', prompt: 'Kodak Portra 400 film stock emulation, natural skin tones' },
                    { id: 'cinestill800', name: 'CineStill 800T', desc: '藍調底片：夜景紅色光暈首選。', prompt: 'CineStill 800T, tungsten balanced, red halation highlights' },
                    { id: 'eterna', name: 'Fujifilm Eterna', desc: '富士電影：低反差柔和，電影質感。', prompt: 'Fujifilm Eterna film stock, low contrast, soft filmic look' },
                    { id: 'velvia', name: 'Fujifilm Velvia 50', desc: '富士鮮豔：風景首選，極高飽和。', prompt: 'Fujifilm Velvia 50, ultra-saturated vivid landscape colors' },
                    { id: 'hp5', name: 'Ilford HP5 Plus', desc: '經典黑白：紀錄片感，強烈顆粒。', prompt: 'Ilford HP5 Plus black and white film, grainy texture' },
                    { id: 'trix400', name: 'Kodak Tri-X 400', desc: '強力黑白：高反差，粗獷有力。', prompt: 'Kodak Tri-X 400 film, high contrast B&W, gritty grain' },
                    { id: 'koda64', name: 'Kodachrome 64', desc: '復古濃郁：濃郁歷史感與紅色。', prompt: 'vintage Kodachrome 64 color science, rich saturated reds' },
                    { id: 'lomopurple', name: 'LomoChrome Purple', desc: '紫色世界：色彩變異，奇幻視覺。', prompt: 'LomoChrome Purple film aesthetic, surreal purple infrared look' },
                    { id: 'vista400', name: 'Agfa Vista 400', desc: '鮮豔紅藍：強烈街頭攝影色彩。', prompt: 'Agfa Vista 400, vibrant street photography colors' },
                    { id: 'wetplate', name: 'Wet Plate', desc: '濕版攝影：古老銀鹽，邊緣化學痕跡。', prompt: 'antique wet plate collodion, silver halide marks, aged texture' },
                    { id: 'cyanotype', name: 'Cyanotype', desc: '藍曬法：深藍影像，工程曬圖質感。', prompt: 'cyanotype alternative process, monochromatic Prussian blue' },
                    { id: 'crossproc', name: 'Cross Processing', desc: '負沖：色偏移、高反差不可預測。', prompt: 'cross processed film look, color shift, high contrast' },
                    { id: 'expired', name: 'Expired Film', desc: '過期底片：褪色、霧化，時光殘影。', prompt: 'expired film aesthetic, faded colors, fogged edges' },
                    { id: 'sepia', name: 'Sepia Tone', desc: '懷舊褐：老照片棕色調，古意。', prompt: 'sepia tone vintage photograph, nostalgic monochrome' },
                    { id: 'tmax', name: 'Kodak T-MAX', desc: '精細紀錄：細膩黑白，極致細節。', prompt: 'Kodak T-MAX 400 film, fine grain B&W, sharp details' },
                    { id: 'infrared', name: 'Rollei Infared 400', desc: '紅外線：異想天開光譜，超脫感。', prompt: 'infrared photography, Rollei Infrared 400 look' },
                    { id: 'provia', name: 'Fujifilm Provia 100F', desc: '準確正片：色彩還原公認最準確。', prompt: 'Fujifilm Provia 100F (RDPIII), accurate slide film colors' },
                    { id: 'reala', name: 'Fujifilm Reala 500D', desc: '自然膚色：高寬容度，柔和色調。', prompt: 'Fujifilm Reala 500D film stock, exceptional skin tones' }
                ],
                focals: [
                    { id: '6mm', name: '6mm ｜ 極廣魚眼', desc: '強烈球型畸變，180度廣闊視角。' },
                    { id: '8mm', name: '8mm ｜ 超廣角', desc: '開闊透視，適合同時拍景與物。' },
                    { id: '12mm', name: '12mm ｜ 廣角', desc: '壯闊風景，強烈空間延伸感。' },
                    { id: '14mm', name: '14mm ｜ 廣角', desc: '標準廣角。' },
                    { id: '24mm', name: '24mm ｜ 廣角標準', desc: '常用於生活紀實廣角。' },
                    { id: '35mm', name: '35mm ｜ 人文視角', desc: '經典報導紀實焦段。' },
                    { id: '50mm', name: '50mm ｜ 人眼透視', desc: '最接近人類雙眼的比例。' },
                    { id: '85mm', name: '85mm ｜ 人像焦段', desc: '優美散景，立體壓縮五官。' },
                    { id: '100mm', name: '100mm ｜ 微距特寫', desc: '極致細節捕捉。' },
                    { id: '200mm', name: '200mm ｜ 長焦壓縮', desc: '背景強烈貼近主體。' },
                    { id: '400mm', name: '400mm ｜ 超長焦', desc: '體育或野生動物專用。' },
                    { id: '600mm', name: '600mm ｜ 極望遠', desc: '極限空間扁平化效果。' },
                    { id: '800mm', name: '800mm ｜ 體育攝影', desc: '極遠物體高清捕捉。' },
                    { id: '1200mm', name: '1200mm ｜ 衛星視角', desc: '極端望遠壓縮。' },
                    { id: '1800mm', name: '1800mm ｜ 超遠視距', desc: '極致望遠能力。' },
                    { id: '5200mm', name: '5200mm ｜ 地球極限', desc: '現存最強光學望遠。' }
                ],
                apertures: [
                    { id: 'T0.95', name: 'T0.95 ｜ 夜神光圈', desc: '夢幻極淺景深。' },
                    { id: 'T1.2', name: 'T1.2 ｜ 極淺景深', desc: '人像極限虛化效果。' },
                    { id: 'T1.4', name: 'T1.4 ｜ 超大光圈', desc: '經典專業電影感。' },
                    { id: 'T1.8', name: 'T1.8 ｜ 大光圈', desc: '標準人像分離感。' },
                    { id: 'T2.0', name: 'T2.0 ｜ 專業光圈', desc: '平衡解析度與景深。' },
                    { id: 'T2.8', name: 'T2.8 ｜ 商業標準', desc: '最穩定的商業畫質點。' },
                    { id: 'T4.0', name: 'T4.0 ｜ 中等光圈', desc: '足夠清晰度與景深。' },
                    { id: 'T5.6', name: 'T5.6 ｜ 畫質頂點', desc: '全畫面細節最豐富。' },
                    { id: 'T8.0', name: 'T8.0 ｜ 風景光圈', desc: '前後景深清晰。' },
                    { id: 'T11', name: 'T11 ｜ 極致深焦', desc: '用於微距或全域對焦。' },
                    { id: 'T16', name: 'T16 ｜ 縮小光圈', desc: '大景深範圍。' },
                    { id: 'T22', name: 'T22 ｜ 最小光圈', desc: '全畫面景物對焦清晰。' }
                ],
                shotTypes: [
                    { id: 'EWS', name: 'EWS ｜ 極大遠景', desc: '壯闊大環境，主體極小。' },
                    { id: 'WS', name: 'WS ｜ 全景', desc: '主體與環境背景皆清晰。' },
                    { id: 'FS', name: 'Full Shot ｜ 全身', desc: '角色頭到腳完整呈現。' },
                    { id: 'MLS', name: 'MLS ｜ 七分身', desc: '強調肢體語言，膝蓋以上。' },
                    { id: 'Cowboy', name: 'Cowboy ｜ 牛仔', desc: '大腿中段以上。' },
                    { id: 'MS', name: 'Medium Shot ｜ 中景', desc: '標準敘事，腰部以上。' },
                    { id: 'MCU', name: 'MCU ｜ 中特寫', desc: '胸部以上。' },
                    { id: 'CU', name: 'Close-Up ｜ 特寫', desc: '專注於面部表情細節。' },
                    { id: 'ECU', name: 'ECU ｜ 極特寫', desc: '聚焦於眼睛等微觀細節。' },
                    { id: 'Macro', name: 'Macro Shot ｜ 微距', desc: '放大極致材質紋理。' }
                ],
                perspectives: [
                    { id: 'eye', name: 'Eye-Level ｜ 平視', desc: '標準視平線，最自然。' },
                    { id: 'low', name: 'Low Angle ｜ 仰視', desc: '低處向高拍，呈現英雄感。' },
                    { id: 'high', name: 'High Angle ｜ 俯視', desc: '高處向下拍，脆弱感。' },
                    { id: 'overhead', name: 'Overhead ｜ 鳥瞰', desc: '垂直向下俯視。' },
                    { id: 'worms', name: 'Worm’s Eye ｜ 蟲眼', desc: '極度貼地仰拍。' },
                    { id: 'dutch', name: 'Dutch Angle ｜ 傾斜', desc: '對角線構圖營造不安。' },
                    { id: 'ots', name: 'OTS ｜ 過肩', desc: '跨過肩膀拍對面主體。' },
                    { id: 'pov', name: 'POV ｜ 第一人稱', desc: '模擬眼球視角。' },
                    { id: 'selfie', name: 'Selfie Angle ｜ 自拍', desc: '手持手臂延伸角度。' },
                    { id: 'ground', name: 'Ground Level ｜ 地平線', desc: '攝影機完全貼地平行。' }
                ],
                aspectRatios: ['1:1', '9:16', '16:9', '3:4', '4:3', '3:2', '2:3', '5:4', '4:5', '21:9']
            };

            const [shots, setShots] = useState(() => JSON.parse(localStorage.getItem('cine_shots_v11_2') || '[]'));
            const [current, setCurrent] = useState(() => JSON.parse(localStorage.getItem('cine_config_v11_2') || JSON.stringify({
                action: '', camera: 'arri65', focal: '35mm', aperture: 'T2.8', lens: 'cooke', 
                perspective: 'eye', shotType: 'MCU', lighting: 'threepoint', lut: 'correct', aspect: '16:9'
            })));
            const [copyId, setCopyId] = useState(null);

            useEffect(() => localStorage.setItem('cine_shots_v11_2', JSON.stringify(shots)), [shots]);
            useEffect(() => localStorage.setItem('cine_config_v11_2', JSON.stringify(current)), [current]);

            const analyzeSubjectBoost = (text) => {
                if (!text) return "";
                const t = text.toLowerCase();
                let boosters = [];
                if (/(man|woman|girl|boy|face|eyes|skin|model|subject|hand|body|character|person|child|old)/i.test(t)) {
                    boosters.push("intricate skin pores, natural skin texture, lifelike hair strands, sub-surface scattering, detailed iris reflections, facial micro-expressions");
                }
                if (/(apple|fruit|bottle|product|glass|liquid|watch|jewelry|car|metal|object|gadget|iphone|phone|watch)/i.test(t)) {
                    boosters.push("physically accurate surface textures, micro-scratches, realistic light refraction and transmission, spectral caustic reflections, premium material rendering");
                }
                if (/(street|city|forest|mountain|room|inside|outside|landscape|interior|exterior)/i.test(t)) {
                    boosters.push("atmospheric depth, high fidelity environmental textures, naturalistic light occlusion");
                }
                return boosters.length > 0 ? boosters.join(", ") : "high precision physical rendering";
            };

            const finalPrompt = useMemo(() => {
                if (!current.action) return "把你心中所想的寫出來...（啟用動態偵測技術）";
                const findP = (cat, id) => {
                    const item = config[cat].find(i => i.id === id);
                    if (!item) return id;
                    return item.prompt || item.name;
                };
                const techChain = [
                    findP('shotTypes', current.shotType),
                    findP('perspectives', current.perspective),
                    current.action,
                    findP('cameras', current.camera),
                    findP('lenses', current.lens),
                    findP('lighting', current.lighting),
                    `focal length ${current.focal}`,
                    `aperture ${current.aperture}`,
                    findP('luts', current.lut)
                ];
                const boost = analyzeSubjectBoost(current.action);
                const quality = "hyper-realistic, 16K resolution, unreal engine 5.4, octane render, physically based rendering (PBR), global illumination, ray-tracing, depth of field";
                const aspect = `--ar ${current.aspect.replace(':', ':')}`;
                return `${techChain.join(", ")}, ${boost}, ${quality} ${aspect}`;
            }, [current]);

            const addShot = () => { if (current.action) { setShots([{ ...current, id: Date.now(), prompt: finalPrompt }, ...shots]); setCurrent({ ...current, action: '' }); } };

            const handleCopy = (text, id) => {
                const el = document.createElement('textarea');
                el.value = text;
                el.style.position = 'fixed'; el.style.left = '-9999px';
                document.body.appendChild(el);
                el.select();
                try { document.execCommand('copy'); setCopyId(id); setTimeout(() => setCopyId(null), 2000); } catch (e) { console.error(e); }
                document.body.removeChild(el);
            };

            // 明確修復 Reset 與 Clear 按鈕功能
            const handleReset = () => {
                if (window.confirm("確定要重置目前的選單參數嗎？")) {
                    const resetConfig = { 
                        action: '', camera: 'arri65', focal: '35mm', aperture: 'T2.8', lens: 'cooke', 
                        perspective: 'eye', shotType: 'MCU', lighting: 'threepoint', lut: 'correct', aspect: '16:9' 
                    };
                    setCurrent(resetConfig);
                }
            };

            const handleClear = () => {
                if (window.confirm("確定要清除所有分鏡紀錄嗎？")) {
                    setShots([]);
                }
            };

            return (
                <div className="min-h-screen bg-[#070708] text-gray-200 font-sans p-2 md:p-6 pb-20">
                    <div className="max-w-screen-2xl mx-auto grid grid-cols-1 xl:grid-cols-12 gap-4 md:gap-6">
                        
                        <div className="xl:col-span-5 space-y-4">
                            <header className="flex items-center justify-between px-2 pt-2">
                                <div className="flex items-center gap-3">
                                    <div className="bg-blue-600 p-2 rounded-xl shadow-lg"><Icon name="Smartphone" size={20} className="text-white" /></div>
                                    <div>
                                        <h1 className="text-lg font-black tracking-tighter text-white uppercase leading-none">CinePrompt Master</h1>
                                        <p className="text-[9px] text-gray-500 uppercase tracking-widest font-bold mt-1">V11.2 | PRODUCTION WORKSTATION</p>
                                    </div>
                                </div>
                                <div className="flex items-center gap-1.5 text-[8px] text-green-400 bg-green-400/5 px-2 py-1 rounded-full border border-green-400/20 font-bold">
                                    <Icon name="Brain" size={10} /> DYNAMIC REASONING
                                </div>
                            </header>

                            <div className="bg-[#121214] border border-gray-800 rounded-3xl p-4 md:p-6 shadow-2xl space-y-5">
                                <div className="space-y-1.5">
                                    <label className="text-[10px] font-black text-gray-500 uppercase flex items-center gap-2 tracking-widest"><Icon name="ChevronRight" size={14} className="text-blue-500" /> Visual Beat 畫面描述</label>
                                    <textarea value={current.action} onChange={(e) => setCurrent({...current, action: e.target.value})} placeholder="把你心中所想的寫出來...（啟用動態偵測技術）" className="w-full bg-[#18181b] border border-gray-800 rounded-2xl p-4 text-sm focus:ring-1 focus:ring-blue-500 outline-none h-28 transition-all resize-none" />
                                </div>

                                <div className="space-y-4">
                                    <div className="grid grid-cols-3 gap-3">
                                        <div className="space-y-1">
                                            <label className="text-[9px] font-black text-gray-400 uppercase flex items-center gap-1"><Icon name="Camera" size={10}/> 攝影機系統</label>
                                            <select value={current.camera} onChange={(e) => setCurrent({...current, camera: e.target.value})} className="w-full bg-[#1c1c1e] border border-gray-800 rounded-xl p-2 text-[10px] outline-none cursor-pointer">
                                                {config.cameras.map(c => <option key={c.id} value={c.id} title={c.desc}>{c.name}</option>)}
                                            </select>
                                        </div>
                                        <div className="space-y-1">
                                            <label className="text-[9px] font-black text-gray-400 uppercase flex items-center gap-1"><Icon name="Focus" size={10}/> 焦距</label>
                                            <select value={current.focal} onChange={(e) => setCurrent({...current, focal: e.target.value})} className="w-full bg-[#1c1c1e] border border-gray-800 rounded-xl p-2 text-[10px] outline-none cursor-pointer">
                                                {config.focals.map(f => <option key={f.id} value={f.id} title={f.desc}>{f.name}</option>)}
                                            </select>
                                        </div>
                                        <div className="space-y-1">
                                            <label className="text-[9px] font-black text-gray-400 uppercase flex items-center gap-1"><Icon name="Zap" size={10}/> 光圈</label>
                                            <select value={current.aperture} onChange={(e) => setCurrent({...current, aperture: e.target.value})} className="w-full bg-[#1c1c1e] border border-gray-800 rounded-xl p-2 text-[10px] outline-none cursor-pointer">
                                                {config.apertures.map(a => <option key={a.id} value={a.id} title={a.desc}>{a.name}</option>)}
                                            </select>
                                        </div>
                                    </div>

                                    <div className="grid grid-cols-2 gap-3">
                                        <div className="space-y-1">
                                            <label className="text-[9px] font-black text-gray-400 uppercase flex items-center gap-1"><Icon name="Maximize" size={10}/> 鏡頭系列</label>
                                            <select value={current.lens} onChange={(e) => setCurrent({...current, lens: e.target.value})} className="w-full bg-[#1c1c1e] border border-gray-800 rounded-xl p-2 text-[10px] outline-none cursor-pointer">
                                                {config.lenses.map(l => <option key={l.id} value={l.id} title={l.desc}>{l.name}</option>)}
                                            </select>
                                        </div>
                                        <div className="space-y-1">
                                            <label className="text-[9px] font-black text-gray-400 uppercase flex items-center gap-1"><Icon name="Layers" size={10}/> 拍攝視角</label>
                                            <select value={current.perspective} onChange={(e) => setCurrent({...current, perspective: e.target.value})} className="w-full bg-[#1c1c1e] border border-gray-800 rounded-xl p-2 text-[10px] outline-none cursor-pointer">
                                                {config.perspectives.map(p => <option key={p.id} value={p.id} title={p.desc}>{p.name}</option>)}
                                            </select>
                                        </div>
                                    </div>

                                    <div className="grid grid-cols-2 gap-3">
                                        <div className="space-y-1">
                                            <label className="text-[9px] font-black text-gray-400 uppercase flex items-center gap-1"><Icon name="Eye" size={10}/> 畫面景別</label>
                                            <select value={current.shotType} onChange={(e) => setCurrent({...current, shotType: e.target.value})} className="w-full bg-[#1c1c1e] border border-gray-800 rounded-xl p-2 text-[10px] outline-none cursor-pointer">
                                                {config.shotTypes.map(s => <option key={s.id} value={s.id} title={s.desc}>{s.name}</option>)}
                                            </select>
                                        </div>
                                        <div className="space-y-1">
                                            <label className="text-[9px] font-black text-yellow-500 uppercase flex items-center gap-1"><Icon name="Sun" size={10}/> 燈光設定</label>
                                            <select value={current.lighting} onChange={(e) => setCurrent({...current, lighting: e.target.value})} className="w-full bg-[#1c1c1e] border border-yellow-900/20 rounded-xl p-2 text-[10px] outline-none text-yellow-500/80 cursor-pointer">
                                                {config.lighting.map(l => <option key={l.id} value={l.id} title={l.desc}>{l.name}</option>)}
                                            </select>
                                        </div>
                                    </div>

                                    <div className="grid grid-cols-2 gap-3">
                                        <div className="space-y-1">
                                            <label className="text-[9px] font-black text-gray-400 uppercase flex items-center gap-1"><Icon name="Palette" size={10}/> 色彩 LUT</label>
                                            <select value={current.lut} onChange={(e) => setCurrent({...current, lut: e.target.value})} className="w-full bg-[#1c1c1e] border border-gray-800 rounded-xl p-2 text-[10px] outline-none cursor-pointer">
                                                {config.luts.map(u => <option key={u.id} value={u.id} title={u.desc}>{u.name}</option>)}
                                            </select>
                                        </div>
                                        <div className="space-y-1">
                                            <label className="text-[9px] font-black text-gray-400 uppercase flex items-center gap-1"><Icon name="Monitor" size={10}/> 輸出比例</label>
                                            <select value={current.aspect} onChange={(e) => setCurrent({...current, aspect: e.target.value})} className="w-full bg-[#1c1c1e] border border-gray-800 rounded-xl p-2 text-[10px] outline-none cursor-pointer">
                                                {config.aspectRatios.map(r => <option key={r} value={r}>{r}</option>)}
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <button onClick={addShot} disabled={!current.action} className={`w-full py-4 rounded-2xl font-black text-xs uppercase tracking-widest transition-all shadow-lg active:scale-95 ${current.action ? 'bg-blue-600 hover:bg-blue-500 text-white shadow-blue-900/30' : 'bg-gray-800 text-gray-600 cursor-not-allowed'}`}>Add Shot to Timeline</button>
                            </div>

                            <div className="bg-[#121214] border border-blue-900/20 rounded-3xl p-4 relative overflow-hidden group">
                                <div className="absolute top-0 left-0 w-1 h-full bg-blue-600 group-hover:w-2 transition-all"></div>
                                <div className="flex justify-between items-center mb-2">
                                    <label className="text-[9px] font-black text-blue-500 uppercase tracking-widest flex items-center gap-2"><Icon name="Brain" size={10}/> Live Master Prompt</label>
                                    <button onClick={() => handleCopy(finalPrompt, 'live')} className="text-[9px] bg-blue-600/10 text-blue-400 px-3 py-1 rounded-full hover:bg-blue-600/20 font-bold border border-blue-600/20 transition-all active:scale-90">{copyId === 'live' ? 'COPIED!' : 'COPY'}</button>
                                </div>
                                <div className="font-mono text-[10px] leading-relaxed text-gray-500 max-h-[140px] overflow-y-auto custom-scrollbar italic">{finalPrompt}</div>
                            </div>
                        </div>

                        <div className="xl:col-span-7 flex flex-col gap-4">
                            <div className="flex justify-between items-center px-1">
                                <h2 className="text-xs font-black text-gray-500 uppercase tracking-widest flex items-center gap-2"><Icon name="Film" size={16} /> Shot List Timeline</h2>
                                <div className="flex gap-4">
                                    <button onClick={handleReset} className="text-[10px] font-bold text-gray-500 hover:text-white flex items-center gap-1 transition-colors"><Icon name="RotateCcw" size={14}/> RESET</button>
                                    <button onClick={handleClear} className="text-[10px] font-bold text-red-500/80 hover:text-red-500 flex items-center gap-1 transition-colors"><Icon name="Trash2" size={14}/> CLEAR</button>
                                    <button onClick={() => { 
                                        let csv = "Shot#,Action,Specs,Prompt\n";
                                        shots.forEach((s, i) => csv += `${shots.length-i},"${s.action}","${s.camera}|${s.lens}","${s.prompt}"\n`);
                                        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                                        const url = URL.createObjectURL(blob);
                                        const link = document.createElement("a");
                                        link.href = url; link.download = `Ian_Production_ShotList.csv`; link.click();
                                    }} className="text-[10px] font-bold text-blue-500 hover:text-blue-400 flex items-center gap-1 transition-colors"><Icon name="Download" size={14}/> EXPORT</button>
                                </div>
                            </div>

                            <div className="bg-[#121214] border border-gray-800 rounded-3xl flex-1 overflow-hidden shadow-inner flex flex-col">
                                <div className="overflow-y-auto max-h-[750px] custom-scrollbar">
                                    <table className="w-full text-left text-xs">
                                        <thead className="bg-[#18181b] text-[9px] text-gray-500 uppercase font-black border-b border-gray-800 sticky top-0 z-10">
                                            <tr>
                                                <th className="px-5 py-4 w-12 text-center">#</th>
                                                <th className="px-5 py-4">Visual Beats</th>
                                                <th className="px-5 py-4 w-44">Technical Specs</th>
                                                <th className="px-5 py-4 w-24 text-right">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-gray-800/50">
                                            {shots.length === 0 ? (
                                                <tr><td colSpan="4" className="px-5 py-40 text-center text-gray-600 font-medium italic">尚未建立分鏡，請在左側輸入描述...</td></tr>
                                            ) : (
                                                shots.map((s, idx) => (
                                                    <tr key={s.id} className="hover:bg-blue-600/5 transition-colors group">
                                                        <td className="px-5 py-6 text-gray-600 font-bold text-center">{shots.length - idx}</td>
                                                        <td className="px-5 py-6">
                                                            <div className="font-black text-gray-100 mb-1.5 leading-tight text-sm">{s.action}</div>
                                                            <div className="text-[10px] text-blue-500/60 font-mono line-clamp-2 leading-relaxed italic">{s.prompt}</div>
                                                        </td>
                                                        <td className="px-5 py-6">
                                                            <div className="flex flex-wrap gap-1.5">
                                                                <span className="text-[8px] bg-blue-900/20 text-blue-400 px-1.5 py-0.5 rounded-lg border border-blue-900/30 font-bold uppercase">{s.shotType}</span>
                                                                <span className="text-[8px] bg-gray-800 text-gray-400 px-1.5 py-0.5 rounded-lg font-bold uppercase">{s.focal}</span>
                                                                <span className="text-[8px] bg-yellow-900/20 text-yellow-500 px-1.5 py-0.5 rounded-lg border border-yellow-900/30 font-bold uppercase">
                                                                    {config.luts.find(l => l.id === s.lut)?.name.split('｜')[0].trim().split(' ')[0]}
                                                                </span>
                                                                <span className="text-[8px] bg-white/5 text-gray-500 px-1.5 py-0.5 rounded-lg border border-white/10 font-bold uppercase">{s.aspect}</span>
                                                            </div>
                                                        </td>
                                                        <td className="px-5 py-6 text-right">
                                                            <div className="flex justify-end gap-3 opacity-60 group-hover:opacity-100 transition-opacity">
                                                                <button onClick={() => handleCopy(s.prompt, s.id)} className={`p-2.5 rounded-xl transition-all active:scale-90 ${copyId === s.id ? 'bg-green-600 text-white' : 'bg-gray-800 text-gray-400 hover:text-white hover:bg-blue-600'}`}>
                                                                    {copyId === s.id ? <Icon name="CheckCircle2" size={16} /> : <Icon name="Copy" size={16} />}
                                                                </button>
                                                                <button onClick={() => setShots(shots.filter(i => i.id !== s.id))} className="p-2.5 rounded-xl bg-gray-800 text-gray-400 hover:text-white hover:bg-red-600 transition-all active:scale-90"><Icon name="Trash2" size={16} /></button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                ))
                                            )}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <footer className="text-[9px] text-gray-700 flex justify-between items-center px-2 font-black mt-2">
                                <div className="flex gap-4">
                                    <span>PBR ACTIVE</span>
                                    <span>16K SUPER-RES ENHANCED</span>
                                </div>
                                <div>© 2026 CINEPROMPT MASTER WORKSTATION</div>
                            </footer>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>